module Generate where

import Data.Bits
import Data.Monoid
--import Parser (Opcode, ParseNode(..))
import Parser

-- TODO:
-- alias Int -> Command
-- use Bytes instead of Int
-- ensure numbers don't exceed text size

convertNum16 :: Int -> [Int]
convertNum16 n = [n .&. 0x00FF, n .&. 0xFF00]

convertNum8 :: Int -> [Int]
convertNum8 n = [n .&. 0x00FF]

emit :: Int -> Maybe [Int]
emit op = Just [op]

emitCB :: Int -> Maybe [Int]
emitCB op = Just [0xCB, op]

emitN :: Int -> Int -> Maybe [Int]
emitN op n = Just (op:convertNum8 n)

emitNN :: Int -> Int -> Maybe [Int]
emitNN op nn = Just (op:convertNum16 nn)

-- TODO: optimization: convert LD (nn),A to LD ($FF00+n) when appropriate

convert :: ParseNode -> Maybe [Int]
convert (NullaryOpNode NOP)                              = emit 0x00
convert (BinaryOpNode LD (RegNode BC) (NumNode nn))      = emitNN 0x01 nn
convert (BinaryOpNode LD (MemRegNode BC) (RegNode A))    = emit 0x02
convert (UnaryOpNode INC (RegNode BC))                   = emit 0x03
convert (UnaryOpNode INC (RegNode B))                    = emit 0x04
convert (UnaryOpNode DEC (RegNode B))                    = emit 0x05
convert (BinaryOpNode LD (RegNode B) (NumNode n))        = emitN 0x06 n
convert (NullaryOpNode RLCA)                             = emit 0x07
convert (BinaryOpNode LD (MemNode addr) (RegNode SP))    = emitNN 0x08 addr
convert (BinaryOpNode ADD (RegNode HL) (RegNode BC))     = emit 0x09
convert (BinaryOpNode LD (RegNode A) (MemRegNode BC))    = emit 0x0A
convert (UnaryOpNode DEC (RegNode BC))                   = emit 0x0B
convert (UnaryOpNode INC (RegNode C))                    = emit 0x0C
convert (UnaryOpNode DEC (RegNode C))                    = emit 0x0D
convert (BinaryOpNode LD (RegNode C) (NumNode n))        = emitN 0x0E n
convert (NullaryOpNode RRCA)                             = emit 0x0F
convert (NullaryOpNode STOP)                             = emit 0x10
convert (BinaryOpNode LD (RegNode DE) (NumNode nn))      = emitNN 0x11 nn
convert (BinaryOpNode LD (MemRegNode DE) (RegNode A))    = emit 0x12
convert (UnaryOpNode INC (RegNode DE))                   = emit 0x13
convert (UnaryOpNode INC (RegNode D))                    = emit 0x14
convert (UnaryOpNode DEC (RegNode D))                    = emit 0x15
convert (BinaryOpNode LD (RegNode D) (NumNode n))        = emitN 0x16 n
convert (NullaryOpNode RLA)                              = emit 0x17
convert (UnaryOpNode JR (NumNode e))                     = emitN 0x18 e
convert (BinaryOpNode ADD (RegNode HL) (RegNode DE))     = emit 0x19
convert (BinaryOpNode LD (RegNode A) (MemRegNode DE))    = emit 0x1A
convert (UnaryOpNode DEC (RegNode DE))                   = emit 0x1B
convert (UnaryOpNode INC (RegNode E))                    = emit 0x1C
convert (UnaryOpNode DEC (RegNode E))                    = emit 0x1D
convert (BinaryOpNode LD (RegNode E) (NumNode n))        = emitN 0x1E n
convert (NullaryOpNode RRA)                              = emit 0x1F
convert (BinaryOpNode JR (FlagNode FlagNZ) (NumNode e))  = emitN 0x20 e
convert (BinaryOpNode LD (RegNode HL) (NumNode nn))      = emitNN 0x21 nn
convert (BinaryOpNode LDI (MemRegNode HL) (RegNode A))   = emit 0x22
convert (UnaryOpNode INC (RegNode HL))                   = emit 0x23
convert (UnaryOpNode INC (RegNode H))                    = emit 0x24
convert (UnaryOpNode DEC (RegNode H))                    = emit 0x25
convert (BinaryOpNode LD (RegNode H) (NumNode n))        = emitN 0x26 n
convert (NullaryOpNode DAA)                              = emit 0x27
convert (BinaryOpNode JR (FlagNode FlagZ) (NumNode e))   = emitN 0x28 e
convert (BinaryOpNode ADD (RegNode HL) (RegNode HL))     = emit 0x29
convert (BinaryOpNode LDI (RegNode A) (MemRegNode HL))   = emit 0x2A
convert (UnaryOpNode DEC (RegNode HL))                   = emit 0x2B
convert (UnaryOpNode INC (RegNode L))                    = emit 0x2C
convert (UnaryOpNode DEC (RegNode L))                    = emit 0x2D
convert (BinaryOpNode LD (RegNode L) (NumNode n))        = emitN 0x2E n
convert (NullaryOpNode CPL)                              = emit 0x2F
convert (BinaryOpNode JR (FlagNode FlagNC) (NumNode e))  = emitN 0x30 e
convert (BinaryOpNode LD (RegNode SP) (NumNode nn))      = emitNN 0x31 nn
convert (BinaryOpNode LDD (MemRegNode HL) (RegNode A))   = emit 0x32
convert (UnaryOpNode INC (RegNode SP))                   = emit 0x33
convert (UnaryOpNode INC (MemRegNode HL))                = emit 0x34
convert (UnaryOpNode DEC (MemRegNode HL))                = emit 0x35
convert (BinaryOpNode LD (MemRegNode HL) (NumNode n))    = emitN 0x36 n
convert (NullaryOpNode SCF)                              = emit 0x37
convert (BinaryOpNode JR (FlagNode FlagC) (NumNode e))   = emitN 0x38 e
convert (BinaryOpNode ADD (RegNode HL) (RegNode SP))     = emit 0x39
convert (BinaryOpNode LDD (RegNode A) (MemRegNode HL))   = emit 0x3A
convert (UnaryOpNode DEC (RegNode SP))                   = emit 0x3B
convert (UnaryOpNode INC (RegNode A))                    = emit 0x3C
convert (UnaryOpNode DEC (RegNode A))                    = emit 0x3D
convert (BinaryOpNode LD (RegNode A) (NumNode n))        = emitN 0x3E n
convert (NullaryOpNode CCF)                              = emit 0x3F
convert (BinaryOpNode LD (RegNode B) (RegNode B))        = emit 0x40
convert (BinaryOpNode LD (RegNode B) (RegNode C))        = emit 0x41
convert (BinaryOpNode LD (RegNode B) (RegNode D))        = emit 0x42
convert (BinaryOpNode LD (RegNode B) (RegNode E))        = emit 0x43
convert (BinaryOpNode LD (RegNode B) (RegNode H))        = emit 0x44
convert (BinaryOpNode LD (RegNode B) (RegNode L))        = emit 0x45
convert (BinaryOpNode LD (RegNode B) (MemRegNode HL))    = emit 0x46
convert (BinaryOpNode LD (RegNode B) (RegNode A))        = emit 0x47
convert (BinaryOpNode LD (RegNode C) (RegNode B))        = emit 0x48
convert (BinaryOpNode LD (RegNode C) (RegNode C))        = emit 0x49
convert (BinaryOpNode LD (RegNode C) (RegNode D))        = emit 0x4A
convert (BinaryOpNode LD (RegNode C) (RegNode E))        = emit 0x4B
convert (BinaryOpNode LD (RegNode C) (RegNode H))        = emit 0x4C
convert (BinaryOpNode LD (RegNode C) (RegNode L))        = emit 0x4D
convert (BinaryOpNode LD (RegNode C) (MemRegNode HL))    = emit 0x4E
convert (BinaryOpNode LD (RegNode C) (RegNode A))        = emit 0x4F
convert (BinaryOpNode LD (RegNode D) (RegNode B))        = emit 0x50
convert (BinaryOpNode LD (RegNode D) (RegNode C))        = emit 0x51
convert (BinaryOpNode LD (RegNode D) (RegNode D))        = emit 0x52
convert (BinaryOpNode LD (RegNode D) (RegNode E))        = emit 0x53
convert (BinaryOpNode LD (RegNode D) (RegNode H))        = emit 0x54
convert (BinaryOpNode LD (RegNode D) (RegNode L))        = emit 0x55
convert (BinaryOpNode LD (RegNode D) (MemRegNode HL))    = emit 0x56
convert (BinaryOpNode LD (RegNode D) (RegNode A))        = emit 0x57
convert (BinaryOpNode LD (RegNode E) (RegNode B))        = emit 0x58
convert (BinaryOpNode LD (RegNode E) (RegNode C))        = emit 0x59
convert (BinaryOpNode LD (RegNode E) (RegNode D))        = emit 0x5A
convert (BinaryOpNode LD (RegNode E) (RegNode E))        = emit 0x5B
convert (BinaryOpNode LD (RegNode E) (RegNode H))        = emit 0x5C
convert (BinaryOpNode LD (RegNode E) (RegNode L))        = emit 0x5D
convert (BinaryOpNode LD (RegNode E) (MemRegNode HL))    = emit 0x5E
convert (BinaryOpNode LD (RegNode E) (RegNode A))        = emit 0x5F
convert (BinaryOpNode LD (RegNode H) (RegNode B))        = emit 0x60
convert (BinaryOpNode LD (RegNode H) (RegNode C))        = emit 0x61
convert (BinaryOpNode LD (RegNode H) (RegNode D))        = emit 0x62
convert (BinaryOpNode LD (RegNode H) (RegNode E))        = emit 0x63
convert (BinaryOpNode LD (RegNode H) (RegNode H))        = emit 0x64
convert (BinaryOpNode LD (RegNode H) (RegNode L))        = emit 0x65
convert (BinaryOpNode LD (RegNode H) (MemRegNode HL))    = emit 0x66
convert (BinaryOpNode LD (RegNode H) (RegNode A))        = emit 0x67
convert (BinaryOpNode LD (RegNode L) (RegNode B))        = emit 0x68
convert (BinaryOpNode LD (RegNode L) (RegNode C))        = emit 0x69
convert (BinaryOpNode LD (RegNode L) (RegNode D))        = emit 0x6A
convert (BinaryOpNode LD (RegNode L) (RegNode E))        = emit 0x6B
convert (BinaryOpNode LD (RegNode L) (RegNode H))        = emit 0x6C
convert (BinaryOpNode LD (RegNode L) (RegNode L))        = emit 0x6D
convert (BinaryOpNode LD (RegNode L) (MemRegNode HL))    = emit 0x6E
convert (BinaryOpNode LD (RegNode L) (RegNode A))        = emit 0x6F
convert (BinaryOpNode LD (MemRegNode HL) (RegNode B))    = emit 0x70
convert (BinaryOpNode LD (MemRegNode HL) (RegNode C))    = emit 0x71
convert (BinaryOpNode LD (MemRegNode HL) (RegNode D))    = emit 0x72
convert (BinaryOpNode LD (MemRegNode HL) (RegNode E))    = emit 0x73
convert (BinaryOpNode LD (MemRegNode HL) (RegNode H))    = emit 0x74
convert (BinaryOpNode LD (MemRegNode HL) (RegNode L))    = emit 0x75
convert (NullaryOpNode HALT)                             = emit 0x76
convert (BinaryOpNode LD (MemRegNode HL) (RegNode A))    = emit 0x77
convert (BinaryOpNode LD (RegNode A) (RegNode B))        = emit 0x78
convert (BinaryOpNode LD (RegNode A) (RegNode C))        = emit 0x79
convert (BinaryOpNode LD (RegNode A) (RegNode D))        = emit 0x7A
convert (BinaryOpNode LD (RegNode A) (RegNode E))        = emit 0x7B
convert (BinaryOpNode LD (RegNode A) (RegNode H))        = emit 0x7C
convert (BinaryOpNode LD (RegNode A) (RegNode L))        = emit 0x7D
convert (BinaryOpNode LD (RegNode A) (MemRegNode HL))    = emit 0x7E
convert (BinaryOpNode LD (RegNode A) (RegNode A))        = emit 0x7F
convert (BinaryOpNode ADD (RegNode A) (RegNode B))       = emit 0x80
convert (BinaryOpNode ADD (RegNode A) (RegNode C))       = emit 0x81
convert (BinaryOpNode ADD (RegNode A) (RegNode D))       = emit 0x82
convert (BinaryOpNode ADD (RegNode A) (RegNode E))       = emit 0x83
convert (BinaryOpNode ADD (RegNode A) (RegNode H))       = emit 0x84
convert (BinaryOpNode ADD (RegNode A) (RegNode L))       = emit 0x85
convert (BinaryOpNode ADD (RegNode A) (MemRegNode HL))   = emit 0x86
convert (BinaryOpNode ADD (RegNode A) (RegNode A))       = emit 0x87
convert (BinaryOpNode ADC (RegNode A) (RegNode B))       = emit 0x88
convert (BinaryOpNode ADC (RegNode A) (RegNode C))       = emit 0x89
convert (BinaryOpNode ADC (RegNode A) (RegNode D))       = emit 0x8A
convert (BinaryOpNode ADC (RegNode A) (RegNode E))       = emit 0x8B
convert (BinaryOpNode ADC (RegNode A) (RegNode H))       = emit 0x8C
convert (BinaryOpNode ADC (RegNode A) (RegNode L))       = emit 0x8D
convert (BinaryOpNode ADC (RegNode A) (MemRegNode HL))   = emit 0x8E
convert (BinaryOpNode ADC (RegNode A) (RegNode A))       = emit 0x8F
convert (UnaryOpNode SUB (RegNode B))                    = emit 0x90
convert (UnaryOpNode SUB (RegNode C))                    = emit 0x91
convert (UnaryOpNode SUB (RegNode D))                    = emit 0x92
convert (UnaryOpNode SUB (RegNode E))                    = emit 0x93
convert (UnaryOpNode SUB (RegNode H))                    = emit 0x94
convert (UnaryOpNode SUB (RegNode L))                    = emit 0x95
convert (UnaryOpNode SUB (MemRegNode HL))                = emit 0x96
convert (UnaryOpNode SUB (RegNode A))                    = emit 0x97
convert (BinaryOpNode SBC (RegNode A) (RegNode B))       = emit 0x98
convert (BinaryOpNode SBC (RegNode A) (RegNode C))       = emit 0x99
convert (BinaryOpNode SBC (RegNode A) (RegNode D))       = emit 0x9A
convert (BinaryOpNode SBC (RegNode A) (RegNode E))       = emit 0x9B
convert (BinaryOpNode SBC (RegNode A) (RegNode H))       = emit 0x9C
convert (BinaryOpNode SBC (RegNode A) (RegNode L))       = emit 0x9D
convert (BinaryOpNode SBC (RegNode A) (MemRegNode HL))   = emit 0x9E
convert (BinaryOpNode SBC (RegNode A) (RegNode A))       = emit 0x9F
convert (UnaryOpNode AND (RegNode B))                    = emit 0xA0
convert (UnaryOpNode AND (RegNode C))                    = emit 0xA1
convert (UnaryOpNode AND (RegNode D))                    = emit 0xA2
convert (UnaryOpNode AND (RegNode E))                    = emit 0xA3
convert (UnaryOpNode AND (RegNode H))                    = emit 0xA4
convert (UnaryOpNode AND (RegNode L))                    = emit 0xA5
convert (UnaryOpNode AND (MemRegNode HL))                = emit 0xA6
convert (UnaryOpNode AND (RegNode A))                    = emit 0xA7
convert (UnaryOpNode XOR (RegNode B))                    = emit 0xA8
convert (UnaryOpNode XOR (RegNode C))                    = emit 0xA9
convert (UnaryOpNode XOR (RegNode D))                    = emit 0xAA
convert (UnaryOpNode XOR (RegNode E))                    = emit 0xAB
convert (UnaryOpNode XOR (RegNode H))                    = emit 0xAC
convert (UnaryOpNode XOR (RegNode L))                    = emit 0xAD
convert (UnaryOpNode XOR (MemRegNode HL))                = emit 0xAE
convert (UnaryOpNode XOR (RegNode A))                    = emit 0xAF
convert (UnaryOpNode OR (RegNode B))                     = emit 0xB0
convert (UnaryOpNode OR (RegNode C))                     = emit 0xB1
convert (UnaryOpNode OR (RegNode D))                     = emit 0xB2
convert (UnaryOpNode OR (RegNode E))                     = emit 0xB3
convert (UnaryOpNode OR (RegNode H))                     = emit 0xB4
convert (UnaryOpNode OR (RegNode L))                     = emit 0xB5
convert (UnaryOpNode OR (MemRegNode HL))                 = emit 0xB6
convert (UnaryOpNode OR (RegNode A))                     = emit 0xB7
convert (UnaryOpNode CP (RegNode B))                     = emit 0xB8
convert (UnaryOpNode CP (RegNode C))                     = emit 0xB9
convert (UnaryOpNode CP (RegNode D))                     = emit 0xBA
convert (UnaryOpNode CP (RegNode E))                     = emit 0xBB
convert (UnaryOpNode CP (RegNode H))                     = emit 0xBC
convert (UnaryOpNode CP (RegNode L))                     = emit 0xBD
convert (UnaryOpNode CP (MemRegNode HL))                 = emit 0xBE
convert (UnaryOpNode CP (RegNode A))                     = emit 0xBF
convert (UnaryOpNode RET (FlagNode FlagNZ))              = emit 0xC0
convert (UnaryOpNode POP (RegNode BC))                   = emit 0xC1
convert (BinaryOpNode JP (FlagNode FlagNZ) (NumNode nn)) = emitNN 0xC2 nn
convert (UnaryOpNode JP (NumNode nn))                    = emitNN 0xC3 nn
convert (BinaryOpNode CALL (FlagNode FlagNZ) (NumNode nn)) = emitNN 0xC4 nn
convert (UnaryOpNode PUSH (RegNode BC))                  = emit 0xC5
convert (BinaryOpNode ADD (RegNode A) (NumNode n))       = emitN 0xC6 n
convert (UnaryOpNode RST (NumNode 0))                    = emit 0xC7
convert (UnaryOpNode RET (FlagNode FlagZ))               = emit 0xC8
convert (NullaryOpNode RET)                              = emit 0xC9
convert (BinaryOpNode JP (FlagNode FlagZ) (NumNode nn))  = emitNN 0xCA nn
convert (UnaryOpNode RLC (RegNode B))                    = emitCB 0x00
convert (UnaryOpNode RLC (RegNode C))                    = emitCB 0x01
convert (UnaryOpNode RLC (RegNode D))                    = emitCB 0x02
convert (UnaryOpNode RLC (RegNode E))                    = emitCB 0x03
convert (UnaryOpNode RLC (RegNode H))                    = emitCB 0x04
convert (UnaryOpNode RLC (RegNode L))                    = emitCB 0x05
convert (UnaryOpNode RLC (MemRegNode HL))                = emitCB 0x06
convert (UnaryOpNode RLC (RegNode A))                    = emitCB 0x07
convert (UnaryOpNode RRC (RegNode B))                    = emitCB 0x08
convert (UnaryOpNode RRC (RegNode C))                    = emitCB 0x09
convert (UnaryOpNode RRC (RegNode D))                    = emitCB 0x0A
convert (UnaryOpNode RRC (RegNode E))                    = emitCB 0x0B
convert (UnaryOpNode RRC (RegNode H))                    = emitCB 0x0C
convert (UnaryOpNode RRC (RegNode L))                    = emitCB 0x0D
convert (UnaryOpNode RRC (MemRegNode HL))                = emitCB 0x0E
convert (UnaryOpNode RRC (RegNode A))                    = emitCB 0x0F
convert (UnaryOpNode RL (RegNode B))                     = emitCB 0x10
convert (UnaryOpNode RL (RegNode C))                     = emitCB 0x11
convert (UnaryOpNode RL (RegNode D))                     = emitCB 0x12
convert (UnaryOpNode RL (RegNode E))                     = emitCB 0x13
convert (UnaryOpNode RL (RegNode H))                     = emitCB 0x14
convert (UnaryOpNode RL (RegNode L))                     = emitCB 0x15
convert (UnaryOpNode RL (MemRegNode HL))                 = emitCB 0x16
convert (UnaryOpNode RL (RegNode A))                     = emitCB 0x17
convert (UnaryOpNode RR (RegNode B))                     = emitCB 0x18
convert (UnaryOpNode RR (RegNode C))                     = emitCB 0x19
convert (UnaryOpNode RR (RegNode D))                     = emitCB 0x1A
convert (UnaryOpNode RR (RegNode E))                     = emitCB 0x1B
convert (UnaryOpNode RR (RegNode H))                     = emitCB 0x1C
convert (UnaryOpNode RR (RegNode L))                     = emitCB 0x1D
convert (UnaryOpNode RR (MemRegNode HL))                 = emitCB 0x1E
convert (UnaryOpNode RR (RegNode A))                     = emitCB 0x1F
convert (UnaryOpNode SLA (RegNode B))                    = emitCB 0x20
convert (UnaryOpNode SLA (RegNode C))                    = emitCB 0x21
convert (UnaryOpNode SLA (RegNode D))                    = emitCB 0x22
convert (UnaryOpNode SLA (RegNode E))                    = emitCB 0x23
convert (UnaryOpNode SLA (RegNode H))                    = emitCB 0x24
convert (UnaryOpNode SLA (RegNode L))                    = emitCB 0x25
convert (UnaryOpNode SLA (MemRegNode HL))                = emitCB 0x26
convert (UnaryOpNode SLA (RegNode A))                    = emitCB 0x27
convert (UnaryOpNode SRA (RegNode B))                    = emitCB 0x28
convert (UnaryOpNode SRA (RegNode C))                    = emitCB 0x29
convert (UnaryOpNode SRA (RegNode D))                    = emitCB 0x2A
convert (UnaryOpNode SRA (RegNode E))                    = emitCB 0x2B
convert (UnaryOpNode SRA (RegNode H))                    = emitCB 0x2C
convert (UnaryOpNode SRA (RegNode L))                    = emitCB 0x2D
convert (UnaryOpNode SRA (MemRegNode HL))                = emitCB 0x2E
convert (UnaryOpNode SRA (RegNode A))                    = emitCB 0x2F
convert (UnaryOpNode SWAP (RegNode B))                   = emitCB 0x30
convert (UnaryOpNode SWAP (RegNode C))                   = emitCB 0x31
convert (UnaryOpNode SWAP (RegNode D))                   = emitCB 0x32
convert (UnaryOpNode SWAP (RegNode E))                   = emitCB 0x33
convert (UnaryOpNode SWAP (RegNode H))                   = emitCB 0x34
convert (UnaryOpNode SWAP (RegNode L))                   = emitCB 0x35
convert (UnaryOpNode SWAP (MemRegNode HL))               = emitCB 0x36
convert (UnaryOpNode SWAP (RegNode A))                   = emitCB 0x37
convert (UnaryOpNode SRL (RegNode B))                    = emitCB 0x38
convert (UnaryOpNode SRL (RegNode C))                    = emitCB 0x39
convert (UnaryOpNode SRL (RegNode D))                    = emitCB 0x3A
convert (UnaryOpNode SRL (RegNode E))                    = emitCB 0x3B
convert (UnaryOpNode SRL (RegNode H))                    = emitCB 0x3C
convert (UnaryOpNode SRL (RegNode L))                    = emitCB 0x3D
convert (UnaryOpNode SRL (MemRegNode HL))                = emitCB 0x3E
convert (UnaryOpNode SRL (RegNode A))                    = emitCB 0x3F
convert (BinaryOpNode BIT (NumNode 0) (RegNode B))       = emitCB 0x40
convert (BinaryOpNode BIT (NumNode 0) (RegNode C))       = emitCB 0x41
convert (BinaryOpNode BIT (NumNode 0) (RegNode D))       = emitCB 0x42
convert (BinaryOpNode BIT (NumNode 0) (RegNode E))       = emitCB 0x43
convert (BinaryOpNode BIT (NumNode 0) (RegNode H))       = emitCB 0x44
convert (BinaryOpNode BIT (NumNode 0) (RegNode L))       = emitCB 0x45
convert (BinaryOpNode BIT (NumNode 0) (MemRegNode HL))   = emitCB 0x46
convert (BinaryOpNode BIT (NumNode 0) (RegNode A))       = emitCB 0x47
convert (BinaryOpNode BIT (NumNode 1) (RegNode B))       = emitCB 0x48
convert (BinaryOpNode BIT (NumNode 1) (RegNode C))       = emitCB 0x49
convert (BinaryOpNode BIT (NumNode 1) (RegNode D))       = emitCB 0x4A
convert (BinaryOpNode BIT (NumNode 1) (RegNode E))       = emitCB 0x4B
convert (BinaryOpNode BIT (NumNode 1) (RegNode H))       = emitCB 0x4C
convert (BinaryOpNode BIT (NumNode 1) (RegNode L))       = emitCB 0x4D
convert (BinaryOpNode BIT (NumNode 1) (MemRegNode HL))   = emitCB 0x4E
convert (BinaryOpNode BIT (NumNode 1) (RegNode A))       = emitCB 0x4F
convert (BinaryOpNode BIT (NumNode 2) (RegNode B))       = emitCB 0x50
convert (BinaryOpNode BIT (NumNode 2) (RegNode C))       = emitCB 0x51
convert (BinaryOpNode BIT (NumNode 2) (RegNode D))       = emitCB 0x52
convert (BinaryOpNode BIT (NumNode 2) (RegNode E))       = emitCB 0x53
convert (BinaryOpNode BIT (NumNode 2) (RegNode H))       = emitCB 0x54
convert (BinaryOpNode BIT (NumNode 2) (RegNode L))       = emitCB 0x55
convert (BinaryOpNode BIT (NumNode 2) (MemRegNode HL))   = emitCB 0x56
convert (BinaryOpNode BIT (NumNode 2) (RegNode A))       = emitCB 0x57
convert (BinaryOpNode BIT (NumNode 3) (RegNode B))       = emitCB 0x58
convert (BinaryOpNode BIT (NumNode 3) (RegNode C))       = emitCB 0x59
convert (BinaryOpNode BIT (NumNode 3) (RegNode D))       = emitCB 0x5A
convert (BinaryOpNode BIT (NumNode 3) (RegNode E))       = emitCB 0x5B
convert (BinaryOpNode BIT (NumNode 3) (RegNode H))       = emitCB 0x5C
convert (BinaryOpNode BIT (NumNode 3) (RegNode L))       = emitCB 0x5D
convert (BinaryOpNode BIT (NumNode 3) (MemRegNode HL))   = emitCB 0x5E
convert (BinaryOpNode BIT (NumNode 3) (RegNode A))       = emitCB 0x5F
convert (BinaryOpNode BIT (NumNode 4) (RegNode B))       = emitCB 0x60
convert (BinaryOpNode BIT (NumNode 4) (RegNode C))       = emitCB 0x61
convert (BinaryOpNode BIT (NumNode 4) (RegNode D))       = emitCB 0x62
convert (BinaryOpNode BIT (NumNode 4) (RegNode E))       = emitCB 0x63
convert (BinaryOpNode BIT (NumNode 4) (RegNode H))       = emitCB 0x64
convert (BinaryOpNode BIT (NumNode 4) (RegNode L))       = emitCB 0x65
convert (BinaryOpNode BIT (NumNode 4) (MemRegNode HL))   = emitCB 0x66
convert (BinaryOpNode BIT (NumNode 4) (RegNode A))       = emitCB 0x67
convert (BinaryOpNode BIT (NumNode 5) (RegNode B))       = emitCB 0x68
convert (BinaryOpNode BIT (NumNode 5) (RegNode C))       = emitCB 0x69
convert (BinaryOpNode BIT (NumNode 5) (RegNode D))       = emitCB 0x6A
convert (BinaryOpNode BIT (NumNode 5) (RegNode E))       = emitCB 0x6B
convert (BinaryOpNode BIT (NumNode 5) (RegNode H))       = emitCB 0x6C
convert (BinaryOpNode BIT (NumNode 5) (RegNode L))       = emitCB 0x6D
convert (BinaryOpNode BIT (NumNode 5) (MemRegNode HL))   = emitCB 0x6E
convert (BinaryOpNode BIT (NumNode 5) (RegNode A))       = emitCB 0x6F
convert (BinaryOpNode BIT (NumNode 6) (RegNode B))       = emitCB 0x70
convert (BinaryOpNode BIT (NumNode 6) (RegNode C))       = emitCB 0x71
convert (BinaryOpNode BIT (NumNode 6) (RegNode D))       = emitCB 0x72
convert (BinaryOpNode BIT (NumNode 6) (RegNode E))       = emitCB 0x73
convert (BinaryOpNode BIT (NumNode 6) (RegNode H))       = emitCB 0x74
convert (BinaryOpNode BIT (NumNode 6) (RegNode L))       = emitCB 0x75
convert (BinaryOpNode BIT (NumNode 6) (MemRegNode HL))   = emitCB 0x76
convert (BinaryOpNode BIT (NumNode 6) (RegNode A))       = emitCB 0x77
convert (BinaryOpNode BIT (NumNode 7) (RegNode B))       = emitCB 0x78
convert (BinaryOpNode BIT (NumNode 7) (RegNode C))       = emitCB 0x79
convert (BinaryOpNode BIT (NumNode 7) (RegNode D))       = emitCB 0x7A
convert (BinaryOpNode BIT (NumNode 7) (RegNode E))       = emitCB 0x7B
convert (BinaryOpNode BIT (NumNode 7) (RegNode H))       = emitCB 0x7C
convert (BinaryOpNode BIT (NumNode 7) (RegNode L))       = emitCB 0x7D
convert (BinaryOpNode BIT (NumNode 7) (MemRegNode HL))   = emitCB 0x7E
convert (BinaryOpNode BIT (NumNode 7) (RegNode A))       = emitCB 0x7F
convert (BinaryOpNode RES (NumNode 0) (RegNode B))       = emitCB 0x80
convert (BinaryOpNode RES (NumNode 0) (RegNode C))       = emitCB 0x81
convert (BinaryOpNode RES (NumNode 0) (RegNode D))       = emitCB 0x82
convert (BinaryOpNode RES (NumNode 0) (RegNode E))       = emitCB 0x83
convert (BinaryOpNode RES (NumNode 0) (RegNode H))       = emitCB 0x84
convert (BinaryOpNode RES (NumNode 0) (RegNode L))       = emitCB 0x85
convert (BinaryOpNode RES (NumNode 0) (MemRegNode HL))   = emitCB 0x86
convert (BinaryOpNode RES (NumNode 0) (RegNode A))       = emitCB 0x87
convert (BinaryOpNode RES (NumNode 1) (RegNode B))       = emitCB 0x88
convert (BinaryOpNode RES (NumNode 1) (RegNode C))       = emitCB 0x89
convert (BinaryOpNode RES (NumNode 1) (RegNode D))       = emitCB 0x8A
convert (BinaryOpNode RES (NumNode 1) (RegNode E))       = emitCB 0x8B
convert (BinaryOpNode RES (NumNode 1) (RegNode H))       = emitCB 0x8C
convert (BinaryOpNode RES (NumNode 1) (RegNode L))       = emitCB 0x8D
convert (BinaryOpNode RES (NumNode 1) (MemRegNode HL))   = emitCB 0x8E
convert (BinaryOpNode RES (NumNode 1) (RegNode A))       = emitCB 0x8F
convert (BinaryOpNode RES (NumNode 2) (RegNode B))       = emitCB 0x90
convert (BinaryOpNode RES (NumNode 2) (RegNode C))       = emitCB 0x91
convert (BinaryOpNode RES (NumNode 2) (RegNode D))       = emitCB 0x92
convert (BinaryOpNode RES (NumNode 2) (RegNode E))       = emitCB 0x93
convert (BinaryOpNode RES (NumNode 2) (RegNode H))       = emitCB 0x94
convert (BinaryOpNode RES (NumNode 2) (RegNode L))       = emitCB 0x95
convert (BinaryOpNode RES (NumNode 2) (MemRegNode HL))   = emitCB 0x96
convert (BinaryOpNode RES (NumNode 2) (RegNode A))       = emitCB 0x97
convert (BinaryOpNode RES (NumNode 3) (RegNode B))       = emitCB 0x98
convert (BinaryOpNode RES (NumNode 3) (RegNode C))       = emitCB 0x99
convert (BinaryOpNode RES (NumNode 3) (RegNode D))       = emitCB 0x9A
convert (BinaryOpNode RES (NumNode 3) (RegNode E))       = emitCB 0x9B
convert (BinaryOpNode RES (NumNode 3) (RegNode H))       = emitCB 0x9C
convert (BinaryOpNode RES (NumNode 3) (RegNode L))       = emitCB 0x9D
convert (BinaryOpNode RES (NumNode 3) (MemRegNode HL))   = emitCB 0x9E
convert (BinaryOpNode RES (NumNode 3) (RegNode A))       = emitCB 0x9F
convert (BinaryOpNode RES (NumNode 4) (RegNode B))       = emitCB 0xA0
convert (BinaryOpNode RES (NumNode 4) (RegNode C))       = emitCB 0xA1
convert (BinaryOpNode RES (NumNode 4) (RegNode D))       = emitCB 0xA2
convert (BinaryOpNode RES (NumNode 4) (RegNode E))       = emitCB 0xA3
convert (BinaryOpNode RES (NumNode 4) (RegNode H))       = emitCB 0xA4
convert (BinaryOpNode RES (NumNode 4) (RegNode L))       = emitCB 0xA5
convert (BinaryOpNode RES (NumNode 4) (MemRegNode HL))   = emitCB 0xA6
convert (BinaryOpNode RES (NumNode 4) (RegNode A))       = emitCB 0xA7
convert (BinaryOpNode RES (NumNode 5) (RegNode B))       = emitCB 0xA8
convert (BinaryOpNode RES (NumNode 5) (RegNode C))       = emitCB 0xA9
convert (BinaryOpNode RES (NumNode 5) (RegNode D))       = emitCB 0xAA
convert (BinaryOpNode RES (NumNode 5) (RegNode E))       = emitCB 0xAB
convert (BinaryOpNode RES (NumNode 5) (RegNode H))       = emitCB 0xAC
convert (BinaryOpNode RES (NumNode 5) (RegNode L))       = emitCB 0xAD
convert (BinaryOpNode RES (NumNode 5) (MemRegNode HL))   = emitCB 0xAE
convert (BinaryOpNode RES (NumNode 5) (RegNode A))       = emitCB 0xAF
convert (BinaryOpNode RES (NumNode 6) (RegNode B))       = emitCB 0xB0
convert (BinaryOpNode RES (NumNode 6) (RegNode C))       = emitCB 0xB1
convert (BinaryOpNode RES (NumNode 6) (RegNode D))       = emitCB 0xB2
convert (BinaryOpNode RES (NumNode 6) (RegNode E))       = emitCB 0xB3
convert (BinaryOpNode RES (NumNode 6) (RegNode H))       = emitCB 0xB4
convert (BinaryOpNode RES (NumNode 6) (RegNode L))       = emitCB 0xB5
convert (BinaryOpNode RES (NumNode 6) (MemRegNode HL))   = emitCB 0xB6
convert (BinaryOpNode RES (NumNode 6) (RegNode A))       = emitCB 0xB7
convert (BinaryOpNode RES (NumNode 7) (RegNode B))       = emitCB 0xB8
convert (BinaryOpNode RES (NumNode 7) (RegNode C))       = emitCB 0xB9
convert (BinaryOpNode RES (NumNode 7) (RegNode D))       = emitCB 0xBA
convert (BinaryOpNode RES (NumNode 7) (RegNode E))       = emitCB 0xBB
convert (BinaryOpNode RES (NumNode 7) (RegNode H))       = emitCB 0xBC
convert (BinaryOpNode RES (NumNode 7) (RegNode L))       = emitCB 0xBD
convert (BinaryOpNode RES (NumNode 7) (MemRegNode HL))   = emitCB 0xBE
convert (BinaryOpNode RES (NumNode 7) (RegNode A))       = emitCB 0xBF
convert (BinaryOpNode SET (NumNode 0) (RegNode B))       = emitCB 0xC0
convert (BinaryOpNode SET (NumNode 0) (RegNode C))       = emitCB 0xC1
convert (BinaryOpNode SET (NumNode 0) (RegNode D))       = emitCB 0xC2
convert (BinaryOpNode SET (NumNode 0) (RegNode E))       = emitCB 0xC3
convert (BinaryOpNode SET (NumNode 0) (RegNode H))       = emitCB 0xC4
convert (BinaryOpNode SET (NumNode 0) (RegNode L))       = emitCB 0xC5
convert (BinaryOpNode SET (NumNode 0) (MemRegNode HL))   = emitCB 0xC6
convert (BinaryOpNode SET (NumNode 0) (RegNode A))       = emitCB 0xC7
convert (BinaryOpNode SET (NumNode 1) (RegNode B))       = emitCB 0xC8
convert (BinaryOpNode SET (NumNode 1) (RegNode C))       = emitCB 0xC9
convert (BinaryOpNode SET (NumNode 1) (RegNode D))       = emitCB 0xCA
convert (BinaryOpNode SET (NumNode 1) (RegNode E))       = emitCB 0xCB
convert (BinaryOpNode SET (NumNode 1) (RegNode H))       = emitCB 0xCC
convert (BinaryOpNode SET (NumNode 1) (RegNode L))       = emitCB 0xCD
convert (BinaryOpNode SET (NumNode 1) (MemRegNode HL))   = emitCB 0xCE
convert (BinaryOpNode SET (NumNode 1) (RegNode A))       = emitCB 0xCF
convert (BinaryOpNode SET (NumNode 2) (RegNode B))       = emitCB 0xD0
convert (BinaryOpNode SET (NumNode 2) (RegNode C))       = emitCB 0xD1
convert (BinaryOpNode SET (NumNode 2) (RegNode D))       = emitCB 0xD2
convert (BinaryOpNode SET (NumNode 2) (RegNode E))       = emitCB 0xD3
convert (BinaryOpNode SET (NumNode 2) (RegNode H))       = emitCB 0xD4
convert (BinaryOpNode SET (NumNode 2) (RegNode L))       = emitCB 0xD5
convert (BinaryOpNode SET (NumNode 2) (MemRegNode HL))   = emitCB 0xD6
convert (BinaryOpNode SET (NumNode 2) (RegNode A))       = emitCB 0xD7
convert (BinaryOpNode SET (NumNode 3) (RegNode B))       = emitCB 0xD8
convert (BinaryOpNode SET (NumNode 3) (RegNode C))       = emitCB 0xD9
convert (BinaryOpNode SET (NumNode 3) (RegNode D))       = emitCB 0xDA
convert (BinaryOpNode SET (NumNode 3) (RegNode E))       = emitCB 0xDB
convert (BinaryOpNode SET (NumNode 3) (RegNode H))       = emitCB 0xDC
convert (BinaryOpNode SET (NumNode 3) (RegNode L))       = emitCB 0xDD
convert (BinaryOpNode SET (NumNode 3) (MemRegNode HL))   = emitCB 0xDE
convert (BinaryOpNode SET (NumNode 3) (RegNode A))       = emitCB 0xDF
convert (BinaryOpNode SET (NumNode 4) (RegNode B))       = emitCB 0xE0
convert (BinaryOpNode SET (NumNode 4) (RegNode C))       = emitCB 0xE1
convert (BinaryOpNode SET (NumNode 4) (RegNode D))       = emitCB 0xE2
convert (BinaryOpNode SET (NumNode 4) (RegNode E))       = emitCB 0xE3
convert (BinaryOpNode SET (NumNode 4) (RegNode H))       = emitCB 0xE4
convert (BinaryOpNode SET (NumNode 4) (RegNode L))       = emitCB 0xE5
convert (BinaryOpNode SET (NumNode 4) (MemRegNode HL))   = emitCB 0xE6
convert (BinaryOpNode SET (NumNode 4) (RegNode A))       = emitCB 0xE7
convert (BinaryOpNode SET (NumNode 5) (RegNode B))       = emitCB 0xE8
convert (BinaryOpNode SET (NumNode 5) (RegNode C))       = emitCB 0xE9
convert (BinaryOpNode SET (NumNode 5) (RegNode D))       = emitCB 0xEA
convert (BinaryOpNode SET (NumNode 5) (RegNode E))       = emitCB 0xEB
convert (BinaryOpNode SET (NumNode 5) (RegNode H))       = emitCB 0xEC
convert (BinaryOpNode SET (NumNode 5) (RegNode L))       = emitCB 0xED
convert (BinaryOpNode SET (NumNode 5) (MemRegNode HL))   = emitCB 0xEE
convert (BinaryOpNode SET (NumNode 5) (RegNode A))       = emitCB 0xEF
convert (BinaryOpNode SET (NumNode 6) (RegNode B))       = emitCB 0xF0
convert (BinaryOpNode SET (NumNode 6) (RegNode C))       = emitCB 0xF1
convert (BinaryOpNode SET (NumNode 6) (RegNode D))       = emitCB 0xF2
convert (BinaryOpNode SET (NumNode 6) (RegNode E))       = emitCB 0xF3
convert (BinaryOpNode SET (NumNode 6) (RegNode H))       = emitCB 0xF4
convert (BinaryOpNode SET (NumNode 6) (RegNode L))       = emitCB 0xF5
convert (BinaryOpNode SET (NumNode 6) (MemRegNode HL))   = emitCB 0xF6
convert (BinaryOpNode SET (NumNode 6) (RegNode A))       = emitCB 0xF7
convert (BinaryOpNode SET (NumNode 7) (RegNode B))       = emitCB 0xF8
convert (BinaryOpNode SET (NumNode 7) (RegNode C))       = emitCB 0xF9
convert (BinaryOpNode SET (NumNode 7) (RegNode D))       = emitCB 0xFA
convert (BinaryOpNode SET (NumNode 7) (RegNode E))       = emitCB 0xFB
convert (BinaryOpNode SET (NumNode 7) (RegNode H))       = emitCB 0xFC
convert (BinaryOpNode SET (NumNode 7) (RegNode L))       = emitCB 0xFD
convert (BinaryOpNode SET (NumNode 7) (MemRegNode HL))   = emitCB 0xFE
convert (BinaryOpNode SET (NumNode 7) (RegNode A))       = emitCB 0xFF
convert (BinaryOpNode CALL (FlagNode FlagZ) (NumNode nn))= emitNN 0xCC nn
convert (UnaryOpNode CALL (NumNode nn))                  = emitNN 0xCD nn
convert (BinaryOpNode ADC (RegNode A) (NumNode n))       = emitN 0xCE n
convert (UnaryOpNode RST (NumNode 8))                    = emit 0xCF
convert (UnaryOpNode RET (FlagNode FlagNC))              = emit 0xD0
convert (UnaryOpNode POP (RegNode DE))                   = emit 0xD1
convert (BinaryOpNode JP (FlagNode FlagNC) (NumNode nn)) = emitNN 0xD2 nn
-- 0xD3 is not a valid opcode
convert (BinaryOpNode CALL (FlagNode FlagNC) (NumNode nn)) = emitNN 0xD4 nn
convert (UnaryOpNode PUSH (RegNode DE))                  = emit 0xD5
convert (UnaryOpNode SUB (NumNode n))                    = emitN 0xD6 n
convert (UnaryOpNode RST (NumNode 16))                   = emit 0xD7
convert (UnaryOpNode RET (FlagNode FlagC))               = emit 0xD8
convert (NullaryOpNode RETI)                             = emit 0xD9
convert (BinaryOpNode JP (FlagNode FlagC) (NumNode nn))  = emitNN 0xDA nn
-- 0xDB is not a valid opcode
convert (BinaryOpNode CALL (FlagNode FlagC) (NumNode nn)) = emitNN 0xDC nn
-- 0xDD is not a valid opcode
convert (BinaryOpNode SBC (RegNode A) (NumNode n))       = emitN 0xDE n
convert (UnaryOpNode RST (NumNode 24))                   = emit 0xDF
convert (BinaryOpNode LD (FF00OffsetNode n) (RegNode A)) = emitN 0xE0 n
convert (UnaryOpNode POP (RegNode HL))                   = emit 0xE1
convert (BinaryOpNode LD (FF00OffsetRegNode C) (RegNode A)) = emit 0xE2
-- 0xE3-E4 are not valid opcodes
convert (UnaryOpNode PUSH (RegNode HL))                  = emit 0xE5
convert (UnaryOpNode AND (NumNode n))                    = emit 0xE6
convert (UnaryOpNode RST (NumNode 32))                   = emit 0xE7
convert (BinaryOpNode ADD (RegNode SP) (NumNode dd))     = emitN 0xE8 dd
convert (UnaryOpNode JP (MemRegNode HL))                 = emit 0xE9
convert (BinaryOpNode LD (MemNode nn) (RegNode A))       = emitNN 0xEA nn
-- 0xEB-0xED are not valid opcodes
convert (UnaryOpNode XOR (NumNode n))                    = emitN 0xEE n
convert (UnaryOpNode RST (NumNode 40))                   = emit 0xEF
convert (BinaryOpNode LD (RegNode A) (FF00OffsetNode n)) = emitN 0xF0 n
convert (UnaryOpNode POP (RegNode AF))                   = emit 0xF1
convert (BinaryOpNode LD (RegNode A) (FF00OffsetRegNode C)) = emit 0xF2
convert (NullaryOpNode DI)                               = emit 0xF3
-- 0xF3-E4 are not valid opcodes
convert (UnaryOpNode PUSH (RegNode AF))                  = emit 0xF5
convert (UnaryOpNode OR (NumNode n))                     = emit 0xF6
convert (UnaryOpNode RST (NumNode 48))                   = emit 0xF7
convert (BinaryOpNode LD (RegNode HL) (SPOffsetNode dd)) = emitN 0xF8 dd
convert (UnaryOpNode LD (RegNode SP) (RegNode HL))       = emit 0xF9
convert (BinaryOpNode LD (RegNode A) (MemNode nn))       = emitNN 0xFA nn
convert (NullaryOpNode EI)                               = emit 0xFB
-- 0xFC-0xFD are not valid opcodes
convert (UnaryOpNode CP (NumNode n))                     = emitN 0xFE n
convert (UnaryOpNode RST (NumNode 56))                   = emit 0xFF
convert _                                                = Nothing

generate :: Maybe [ParseNode] -> Maybe [Int]
generate (Just (p:ps)) = convert p `mappend` generate (Just ps)
generate _ = Nothing

